---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readr)
```

#Importing data set

```{r}
install.packages("readxl")
library(readxl)

```

```{r}
air_df <- read_excel("C:/R_coursework/who_ambient_air_quality_database_version_2024_(v6.1) (1).xlsx",sheet = "Update 2024 (V6.1)")

#Database is provided as a multi-sheet Excel workbook. The main air pollution measurements are located in the"Update 2024 (V6.1)" sheet, while the other sheets provide metadata about countries and indicators.
```

# Rewiving data set
```{r}
head(air_df)

```

# create new data farame with sutable clomns
```{r}
air_df1 <- air_df %>%
  select(who_region,iso3,country_name,city,year,pm10_concentration,pm25_concentration,no2_concentration,latitude,longitude,population)
 
air_df1 
```

#finding most appopriate air

```{r}
air_df1[air_df1 == "NA"] <- NA    # when put colMeans(is.na(air_df)) * 100 shows 0 na values for all colomns
sum(is.na(air_df1)) 
```
```{r}
missing_summary <- data.frame(
  Column = colnames(air_df1),
  Missing_Count = colSums(is.na(air_df1)),
  Missing_Percent = round(colMeans(is.na(air_df1)) * 100, 2)
)


print(missing_summary)
```

#filtering sutable air
```{r}
air_df2 <- air_df1 %>%
  select(who_region,iso3,country_name,city,year,pm10_concentration)

air_df2
```


#taking mean value 
```{r}
air_df3 <- air_df2 %>%
  mutate(pm10_concentration = as.numeric(pm10_concentration))%>%
           
  filter(!is.na(pm10_concentration)) %>%    
  group_by( iso3, who_region,country_name, year) %>%
  
  summarise(mean_pm10 = mean(pm10_concentration, na.rm = TRUE))

air_df3 

```

#choosing appopriate year

```{r}
air_df_wide <- air_df3 %>%
  pivot_wider(
    names_from = year,           # column names will be years (2010â€“2022)
    values_from = mean_pm10      # the data values will be the mean PM10
  )%>%
  arrange(who_region, country_name)

air_df_wide
```



 
 